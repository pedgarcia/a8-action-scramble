;------------------------------------------------------------------------------
; VBLANK PROCEDURE CALLED ONCE PER FRAME
;------------------------------------------------------------------------------

PROC VBLANKD=*()
  [PHAXY]
  IF HSCROLI=$B THEN
    IF LMS=LOOPEND THEN
      DRAWLINE() RESETVARS()
    ELSE
      LMS==+1 SCREENI==+1    ; COARSE SCROLL
    FI
    HSCROLI=$F
  FI
  HSCROL=HSCROLI HSCROLI==-1 ; FINE SCROLL
  [PLAXY]
[JMP OLDVBL]
